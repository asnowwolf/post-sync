# 需求：社交媒体自动发文工具

## 1. 项目背景与目标

为了提高内容创作者和运营人员的内容分发效率，减少繁琐的手工操作，本项目旨在开发一个能将本地 Markdown 文稿自动发布到微信公众号的工具。

**核心目标**: 实现一个从本地内容到线上草稿、再到正式发布的完整自动化流程，并能智能地避免重复操作。

## 2. 目标用户

- 内容创作者
- 运营人员
- 希望实现内容自动化发布的开发者

## 3. 功能需求

### 3.1 内容源

- **单篇文章发布**: 支持将单个 Markdown 文件发布为一篇独立的公众号草稿。
- **批量发布 (目录模式)**: 支持将一个目录下的所有 Markdown 文章，按文件名的数字前缀排序后，各自发布为一篇独立的公众号草稿。

### 3.2 内容处理

- **格式转换**: 能够正确解析并转换标准的 Markdown 语法，包括标题、列表、粗体、斜体、引用等。
- **图片处理**:
  - 自动将文章中引用的本地或网络图片上传到公众号，并在文章中正确显示。
  - 支持对图片进行裁剪或缩放，以满足封面图等特定尺寸要求。
- **代码高亮**: 文章中的代码块应支持常见编程语言的语法高亮。

### 3.3 发布与跟踪

- **创建草稿**: 将处理好的内容在公众号后台创建为一篇或多篇草稿。
- **发布草稿**: 支持指定一个或多个已创建的草稿，并将其正式发布。
- **状态跟踪**: 工具应能记录已发布过的文章及其草稿。当用户尝试再次发布时，如果文章内容没有变化，应提示用户，避免重复操作。
- **清理缓存**: 提供命令来清理生成的临时文件，同时保留发布记录。

### 3.4 交互方式 (CLI)

- 工具通过命令行进行操作。
- **创建草稿**:
  - `post-sync create <path-to-file-or-directory>`
- **发布文章**:
  - `post-sync publish <path-to-file-or-directory>`
- **清理缓存**:
  - `post-sync clean`
- **配置参数**:
  - `--appId <your_app_id>`: 微信公众号的 AppID。
  - `--appSecret <your_app_secret>`: 微信公众号的 AppSecret。
  - `--proxy <proxy_url>`: 可选的网络代理。

## 4. 非功能性需求

- **安全**: 用户的 `appId` 和 `appSecret` 等敏感信息不应被硬编码或以不安全的方式存储。
- **健壮性**: 当发生网络错误或文件读取错误时，工具应提供清晰、易于理解的错误提示。
- **易用性**: 命令行指令和参数应简单直观。

## 5. 验收标准

1. 可以成功执行 `create` 命令并指定一个 Markdown 文件或目录。
2. 执行 `create` 后，微信公众号后台草稿箱中出现一篇或多篇新文章。
3. 文章的格式、图片、代码高亮均能正确显示。
4. 当使用 `create` 发布一个目录时，目录下的每篇文章都成功创建了一个独立的草稿，并且发布顺序遵循了文件名数字前缀。
5. 对于已创建草稿且未修改的文章，再次执行 `create` 命令会给出提示，而不是创建一个新的草稿。
6. 可以成功执行 `publish` 命令，并将之前创建的草稿发布为正式文章。
7. 执行 `clean` 命令后，临时文件被删除，但发布记录不受影响。
